<%# app/views/projects/show.html.erb %>
<%# Displays the contents of a project (extracted files from ZIP) %>
<%# Uses the same grid layout as library for consistent UX %>
<% content_for :page_title, "LIBRARY" %>

<%# Breadcrumb navigation - file path style %>
<%= render "projects/breadcrumbs" %>

<%# File grid - same styling as library %>
<div class="drop-zone">
  <% if @files.any? %>
    <div class="projects-grid">
      <% @files.each do |file| %>
        <div class="project-card-wrapper">
          <% if file.is_directory? %>
            <%# Folder - clicking navigates into it %>
            <%= link_to project_path(@project, folder_id: file.id), class: "project-card" do %>
              <div class="project-icon">
                <%= image_tag "icons/folder.svg", class: "icon-image" %>
              </div>
              <p><%= file.original_filename %></p>
            <% end %>
          <% else %>
            <%# File - display with icon %>
            <div class="project-card">
              <div class="project-icon">
                <%= image_tag file_icon_for(file), class: "icon-image" %>
              </div>
              <p><%= file.original_filename %></p>
            </div>
          <% end %>

          <%# Three-dot menu for actions %>
          <div class="card-menu" data-controller="dropdown">
            <button class="menu-trigger" data-action="click->dropdown#toggle">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <circle cx="3" cy="8" r="1.5"/>
                <circle cx="8" cy="8" r="1.5"/>
                <circle cx="13" cy="8" r="1.5"/>
              </svg>
            </button>
            <div class="menu-dropdown" data-dropdown-target="menu">
              <% if file.is_directory? %>
                <%= link_to "Download as ZIP", download_folder_project_path(@project, folder_id: file.id), class: "menu-item" %>
              <% else %>
                <%= link_to "Download", download_file_project_path(@project, file_id: file.id), class: "menu-item" %>
              <% end %>
              <div class="menu-divider"></div>
              <%= link_to "Delete", destroy_file_project_path(@project, file_id: file.id),
                  data: { turbo_method: :delete, turbo_confirm: "Delete '#{file.original_filename}'?#{file.is_directory? ? ' This will delete all contents inside.' : ''}" },
                  class: "menu-item menu-item-danger" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="empty-state">No files found in this project</p>
  <% end %>
</div>
