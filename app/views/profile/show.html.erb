<% content_for :page_title, "PROFILE" %>

<div class="profile-container">

  <!-- Profile Photo -->
  <div class="profile-photo-section">
    <div class="profile-photo">
      <% if @user.avatar.attached? %>
        <%= image_tag @user.avatar, class: "avatar-image" %>
      <% else %>
        <div class="avatar-placeholder">
          <%= @user.username.first.upcase %>
        </div>
      <% end %>
    </div>
    <%= form_with model: @user, url: profile_path, method: :patch, class: "avatar-form" do |f| %>
      <%= f.file_field :avatar, class: "file-input", id: "avatar-input", accept: "image/*" %>
      <label for="avatar-input" class="change-photo-btn">Change photo</label>
    <% end %>
  </div>

  <!-- Stats Row -->
  <div class="profile-stats">
    <div class="stat-item">
      <div class="stat-value"><%= @user.projects.count %></div>
      <div class="stat-label">Projects</div>
    </div>
    <div class="stat-divider"></div>
    <div class="stat-item">
      <div class="stat-value">0</div>
      <div class="stat-label">Collaborators</div>
    </div>
  </div>

  <!-- File Types Breakdown -->
  <div class="profile-breakdown">
    <div class="breakdown-bar">
      <div class="breakdown-segment ableton" style="width: 64%"></div>
      <div class="breakdown-segment wav" style="width: 23%"></div>
      <div class="breakdown-segment mp3" style="width: 13%"></div>
    </div>
    <div class="breakdown-legend">
      <div class="legend-item">
        <span class="legend-dot ableton"></span>
        <span>Ableton</span>
      </div>
      <div class="legend-item">
        <span class="legend-dot wav"></span>
        <span>WAV</span>
      </div>
      <div class="legend-item">
        <span class="legend-dot mp3"></span>
        <span>MP3</span>
      </div>
    </div>
  </div>

  <!-- Profile Fields -->
  <div class="profile-fields">

    <!-- Username -->
    <div class="profile-field">
      <label>Username</label>
      <div class="field-value"><%= @user.username %></div>
      <%= link_to "Edit", edit_profile_path(field: :username), class: "field-action" %>
    </div>

    <!-- Membership -->
    <div class="profile-field">
      <label>Membership</label>
      <div class="field-value">
        <span class="membership-badge free">Free</span>
        <span class="membership-storage">10 GB</span>
      </div>
      <%= link_to "Upgrade", "#", class: "field-action" %>
    </div>

    <!-- Email -->
    <div class="profile-field">
      <label>Email</label>
      <div class="field-value"><%= @user.email %></div>
      <%= link_to "Edit", edit_profile_path(field: :email), class: "field-action" %>
    </div>

    <!-- Password -->
    <div class="profile-field">
      <label>Password</label>
      <div class="field-value">••••••••</div>
      <%= link_to "Change", edit_profile_path(field: :password), class: "field-action" %>
    </div>
  </div>

  <!-- Sign Out -->
  <div class="profile-sign-out">
    <%= button_to "Sign out", destroy_user_session_path, method: :delete, class: "sign-out-link" %>
  </div>
</div>
